<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì¼ì • ìƒì„¸ â€” WorkSpace</title>
<link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>
	<div class="app-wrap">
		<div th:replace="~{fragments/sidebar :: sidebar}"></div>
		<div class="main-content">
			<header th:replace="~{fragments/header :: topbar(title='ì¼ì • ìº˜ë¦°ë”')}"></header>
			<div class="content-body">

				<div class="card" style="max-width: 760px;">
					<div class="card-header">
						<span class="card-title">ğŸ“… ì¼ì • ìƒì„¸</span> <a th:href="@{/schedule}"
							class="btn btn-outline btn-sm">â† ëª©ë¡</a>
					</div>
					<div class="card-body">

						<!-- ì œëª© -->
						<div class="post-title-big" th:text="${schedule.title}">ì¼ì •
							ì œëª©</div>

						<!-- ë©”íƒ€ ì •ë³´ -->
						<div class="post-meta-bar">
							<span>ğŸ‘¤ <span th:text="${schedule.memberName}">í™ê¸¸ë™</span></span>
							<span>ğŸ“… ë“±ë¡ì¼ <span
								th:text="${#temporals.format(schedule.createdAt, 'yyyy.MM.dd')}">2025.06.20</span></span>
							<span th:if="${schedule.isPublic}"><span
								class="badge badge-blue">ê³µê°œ</span></span> <span
								th:unless="${schedule.isPublic}"><span
								class="badge badge-gray">ë¹„ê³µê°œ</span></span>
						</div>

						<!-- ì¼ì‹œ ì •ë³´ -->
						<div
							style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 16px; background: var(--bg-page); border-radius: var(--radius); padding: 16px; border: 1px solid var(--border);">
							<div>
								<div class="field-label">ì‹œì‘ ì¼ì‹œ</div>
								<div
									style="font-size: 15px; font-weight: 700; color: var(--accent); margin-top: 5px;"
									th:text="${#temporals.format(schedule.startDt, 'yyyy.MM.dd HH:mm')}">2025.06.20
									09:00</div>
							</div>
							<div>
								<div class="field-label">ì¢…ë£Œ ì¼ì‹œ</div>
								<div
									style="font-size: 15px; font-weight: 700; color: var(--text-main); margin-top: 5px;"
									th:text="${#temporals.format(schedule.endAt, 'yyyy.MM.dd HH:mm')}">2025.06.20
									18:00</div>
							</div>
						</div>

						<!-- ë‚´ìš© -->
						<div class="post-body" th:text="${schedule.content}">ì¼ì • ë‚´ìš©ì´
							ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>

						<!-- ìˆ˜ì • í¼ -->
						<div id="edit-form" style="display: none; margin-top: 16px;">
							<form
								th:action="@{/schedule/update/{id}(id=${schedule.scheduleId})}"
								method="post">
								<div class="form-group">
									<label class="form-label">ì œëª©</label> <input type="text"
										name="title" class="form-control" th:value="${schedule.title}">
								</div>
								<div class="form-group">
									<label class="form-label">ë‚´ìš©</label>
									<textarea name="content" class="editor-area"
										style="min-height: 100px;" th:text="${schedule.content}"></textarea>
								</div>
								<div class="form-row">
									<div class="form-group">
										<label class="form-label">ì‹œì‘ ì¼ì‹œ</label> <input
											type="datetime-local" name="startDt" class="form-control"
											th:value="${#temporals.format(schedule.startDt, 'yyyy-MM-dd''T''HH:mm')}">
									</div>
									<div class="form-group">
										<label class="form-label">ì¢…ë£Œ ì¼ì‹œ</label> <input
											type="datetime-local" name="endAt" class="form-control"
											th:value="${#temporals.format(schedule.endAt, 'yyyy-MM-dd''T''HH:mm')}">
									</div>
								</div>
								<div class="form-group">
									<label
										style="display: flex; align-items: center; gap: 7px; font-size: 13px; color: var(--text-sub); cursor: pointer;">
										<input type="checkbox" name="isPublic" value="true"
										th:checked="${schedule.isPublic}"
										style="accent-color: var(--accent);"> ì „ì²´ ê³µê°œ
									</label>
								</div>
								<div class="form-actions">
									<button type="button" class="btn btn-outline"
										onclick="toggleEdit()">ì·¨ì†Œ</button>
									<button type="submit" class="btn btn-primary">ìˆ˜ì • ì™„ë£Œ</button>
								</div>
							</form>
						</div>

						<!-- ë²„íŠ¼ -->
						<div class="post-actions" id="action-btns">
							<a th:href="@{/schedule}" class="btn btn-outline btn-sm">â† ëª©ë¡</a>
							<!-- ë³¸ì¸ ì¼ì •ë§Œ ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥ -->
							<div class="post-actions-right"
								th:if="${session.LOGIN_MEMBER.employeeNo == schedule.employeeNo}">
								<button class="btn btn-outline btn-sm" onclick="toggleEdit()">ìˆ˜ì •</button>
								<form
									th:action="@{/schedule/delete/{id}(id=${schedule.scheduleId})}"
									method="post" style="display: inline;"
									onsubmit="return confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">
									<button type="submit" class="btn btn-danger btn-sm">ì‚­ì œ</button>
								</form>
							</div>
						</div>

					</div>
				</div>

			</div>
		</div>
	</div>
	<script th:src="@{/js/script.js}"></script>
	<script>
function toggleEdit() {
  const form = document.getElementById('edit-form');
  const btns = document.getElementById('action-btns');
  const postBody = document.querySelector('.post-body');
  if (form.style.display === 'none') {
    form.style.display = 'block';
    btns.style.display = 'none';
    postBody.style.display = 'none';
  } else {
    form.style.display = 'none';
    btns.style.display = 'flex';
    postBody.style.display = 'block';
  }
}
</script>
</body>
</html>
