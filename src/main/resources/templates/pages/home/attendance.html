<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ê·¼íƒœ ê´€ë¦¬ â€” WorkSpace</title>
  <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>
<div class="app-wrap">
  <div th:replace="~{fragments/sidebar :: sidebar}"></div>
  <div class="main-content">
    <header th:replace="~{fragments/header :: topbar(title='ê·¼íƒœ ê´€ë¦¬')}"></header>
    <div class="content-body">

      <div class="page-header">
        <div>
          <div class="page-title">â± ê·¼íƒœ ê´€ë¦¬</div>
          <div class="page-sub">ì¶œí‡´ê·¼ ê¸°ë¡ì„ í™•ì¸í•˜ì„¸ìš”</div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <span class="card-title">ì¶œí‡´ê·¼ ì²´í¬</span>
        </div>
        <div class="card-body">
          <div style="display:flex;gap:13px;">
            <button type="button" class="btn btn-primary" onclick="openCheckModal('in')">â° ì¶œê·¼ ì²´í¬</button>
            <button type="button" class="btn btn-outline" onclick="openCheckModal('out')">ğŸ  í‡´ê·¼ ì²´í¬</button>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- ì¶œí‡´ê·¼ ì‹œê°„ ì„ íƒ ëª¨ë‹¬ -->
<div id="check-modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.4); z-index:999; align-items:center; justify-content:center;">
  <div class="card" style="width:400px; max-width:90%;">
    <div class="card-header">
      <span class="card-title" id="modal-title">ì¶œê·¼ ì²´í¬</span>
      <button onclick="closeCheckModal()" style="font-size:18px; color:var(--text-muted); cursor:pointer;">âœ•</button>
    </div>
    <div class="card-body">
      <form id="check-form" method="post">
        <div class="form-group">
          <label class="form-label">ì‹œê°„ ì„ íƒ</label>
          <input type="datetime-local" id="check-time" name="checkTime" class="form-control" required>
        </div>
        <div class="form-group">
          <label class="form-label">ìƒíƒœ</label>
          <select name="status" class="form-control">
            <option value="ì •ìƒ">ì •ìƒ</option>
            <option value="ì§€ê°">ì§€ê°</option>
            <option value="ì¡°í‡´">ì¡°í‡´</option>
            <option value="íœ´ê°€">íœ´ê°€</option>
          </select>
        </div>
        <div class="form-actions">
          <button type="button" class="btn btn-outline" onclick="closeCheckModal()">ì·¨ì†Œ</button>
          <button type="submit" class="btn btn-primary" id="modal-submit-btn">ì¶œê·¼</button>
        </div>
      </form>
    </div>
  </div>
</div>

<script th:src="@{/js/script.js}"></script>
<script>
  function openCheckModal(type) {
    const now = new Date();
    const yyyy = now.getFullYear();
    const mm = String(now.getMonth() + 1).padStart(2, '0');
    const dd = String(now.getDate()).padStart(2, '0');
    const hh = String(now.getHours()).padStart(2, '0');
    const mi = String(now.getMinutes()).padStart(2, '0');
    document.getElementById('check-time').value = `${yyyy}-${mm}-${dd}T${hh}:${mi}`;

    if (type === 'in') {
      document.getElementById('modal-title').textContent = 'â° ì¶œê·¼ ì²´í¬';
      document.getElementById('modal-submit-btn').textContent = 'ì¶œê·¼';
      document.getElementById('check-form').action = '/attendance/check-in';
    } else {
      document.getElementById('modal-title').textContent = 'ğŸ  í‡´ê·¼ ì²´í¬';
      document.getElementById('modal-submit-btn').textContent = 'í‡´ê·¼';
      document.getElementById('check-form').action = '/attendance/check-out';
    }
    document.getElementById('check-modal').style.display = 'flex';
  }

  function closeCheckModal() {
    document.getElementById('check-modal').style.display = 'none';
  }

  document.getElementById('check-modal').addEventListener('click', function(e) {
    if (e.target === this) closeCheckModal();
  });
</script>
</body>
</html>